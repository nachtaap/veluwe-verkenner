<!DOCTYPE html>

<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verborgen Pareltjes van de Veluwe</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #2c3e50;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
    }
    
    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .header {
        text-align: center;
        margin-bottom: 40px;
        background: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
    }
    
    .animation-container {
        height: 200px;
        width: 100%;
        position: relative;
        margin: 20px 0;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .car-illustration {
        max-width: 400px;
        max-height: 180px;
        width: auto;
        height: auto;
        animation: slideIn 2s ease-out;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        object-fit: contain;
    }
    
    @keyframes slideIn {
        0% { opacity: 0; transform: translateY(20px); }
        100% { opacity: 1; transform: translateY(0); }
    }
    
    .header h1 {
        color: #2c3e50;
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .header p {
        color: #7f8c8d;
        font-size: 1.2em;
    }
    
    .filter-section {
        margin-top: 20px;
        text-align: center;
    }
    
    .filter-section h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.2em;
    }
    
    .filter-buttons {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
    }
    
    .filter-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-size: 0.9em;
        font-weight: 500;
        transition: all 0.3s ease;
        color: white;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .filter-btn.active {
        border: 3px solid #f1c40f;
        transform: scale(1.05);
        box-shadow: 0 0 15px rgba(241, 196, 15, 0.4);
    }
    
    .filter-btn:not(.active):not(.show-colored) {
        background: linear-gradient(45deg, #bdc3c7, #95a5a6);
    }
    
    .filter-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }
    
    .filter-btn[data-category="all"].active { 
        background: linear-gradient(45deg, #5d4e75, #7b68ee); 
    }
    
    .location-section {
        margin-top: 20px;
        text-align: center;
    }
    
    .location-btn {
        padding: 12px 25px;
        background: linear-gradient(45deg, #27ae60, #2ecc71);
        color: white;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-size: 1em;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .location-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }
    
    .location-btn:disabled {
        background: linear-gradient(45deg, #bdc3c7, #95a5a6);
        cursor: not-allowed;
        transform: none;
    }
    
    .location-status {
        margin-top: 10px;
        font-size: 0.9em;
        color: #7f8c8d;
    }
    
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 25px;
        margin-top: 30px;
    }
    
    .card {
        background: rgba(255, 255, 255, 0.95);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        position: relative;
    }
    
    .card.visited {
        background: rgba(200, 255, 200, 0.95);
        border-left: 4px solid #27ae60;
    }
    
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    }
    
    .card.hidden {
        display: none;
    }
    
    .card h3 {
        margin-bottom: 15px;
        font-size: 1.3em;
    }
    
    .card h3 a {
        color: #3498db;
        text-decoration: none;
        transition: color 0.3s ease;
    }
    
    .card h3 a:hover {
        color: #2980b9;
        text-decoration: underline;
    }
    
    .card p {
        color: #34495e;
        margin-bottom: 10px;
    }
    
    .distance {
        color: #e74c3c;
        font-weight: bold;
        font-size: 0.9em;
    }
    
    .distance.updated {
        color: #27ae60;
        font-weight: bold;
    }
    
    .category {
        display: inline-block;
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8em;
        margin-bottom: 10px;
        font-weight: 500;
    }
    
    .nature { background: linear-gradient(45deg, #27ae60, #2ecc71); }
    .historic { background: linear-gradient(45deg, #8e44ad, #9b59b6); }
    .village { background: linear-gradient(45deg, #f39c12, #e67e22); }
    .water { background: linear-gradient(45deg, #3498db, #2980b9); }
    .viewpoint { background: linear-gradient(45deg, #e74c3c, #c0392b); }
    
    .visited-checkbox {
        position: absolute;
        top: 15px;
        right: 15px;
        width: 20px;
        height: 20px;
        cursor: pointer;
        accent-color: #27ae60;
        transform: scale(1.2);
    }
    
    .visited-label {
        position: absolute;
        top: 12px;
        right: 40px;
        font-size: 0.8em;
        color: #7f8c8d;
        font-weight: 500;
        user-select: none;
        cursor: pointer;
    }
    
    .card.visited .visited-label {
        color: #27ae60;
        font-weight: bold;
    }
    
    .error-message {
        text-align: center;
        color: #e74c3c;
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        border-left: 4px solid #e74c3c;
    }
    
    .loading-message {
        text-align: center;
        color: #3498db;
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
    }
    
    @media (max-width: 768px) {
        .header h1 { font-size: 2em; }
        .grid { grid-template-columns: 1fr; }
        .container { padding: 15px; }
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå≤ Verborgen Pareltjes van de Veluwe</h1>
            <div class="animation-container">
                <img src="62645C44-E0B2-46A1-9CF4-45FF6CE253DE.png" alt="Auto met hondje rijdt door de Veluwe" class="car-illustration" />
            </div>
            <p>Ontdek de mooiste, minder bekende plekken in de Veluwe - allemaal gemakkelijk bereikbaar met de auto</p>

```
        <div class="filter-section">
            <h3>Filter op categorie:</h3>
            <div class="filter-buttons" id="filterButtons">
                <button class="filter-btn active" data-category="all">üåü Alles</button>
            </div>
        </div>
        
        <div class="location-section">
            <button id="locationBtn" class="location-btn">üìç Gebruik mijn locatie voor afstanden</button>
            <div id="locationStatus" class="location-status"></div>
        </div>
    </div>
    
    <div class="grid" id="cardsContainer">
        <div class="loading-message">
            üìç Locaties laden...
        </div>
    </div>
</div>

<script>
    let locationsData = null;
    
    // Functie om afstand te berekenen (Haversine formule)
    function calculateDistance(lat1, lng1, lat2, lng2) {
        const R = 6371;
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLng = (lng2 - lng1) * Math.PI / 180;
        const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLng/2) * Math.sin(dLng/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
    }
    
    // Cookie functies
    function setCookie(name, value, days) {
        const expires = new Date();
        expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
        document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;
    }
    
    function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for(let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }
    
    function saveVisitedPlaces() {
        const visitedPlaces = [];
        const checkboxes = document.querySelectorAll('.visited-checkbox:checked');
        checkboxes.forEach(checkbox => {
            visitedPlaces.push(checkbox.getAttribute('data-place'));
        });
        setCookie('visitedPlaces', JSON.stringify(visitedPlaces), 365);
    }
    
    function loadVisitedPlaces() {
        const visitedPlaces = getCookie('visitedPlaces');
        if (visitedPlaces) {
            try {
                const places = JSON.parse(visitedPlaces);
                places.forEach(place => {
                    const checkbox = document.querySelector(`[data-place="${place}"]`);
                    if (checkbox) {
                        checkbox.checked = true;
                        checkbox.closest('.card').classList.add('visited');
                    }
                });
            } catch (e) {
                console.log('Fout bij laden bezochte plaatsen:', e);
            }
        }
    }
    
    function updateDistances(userLat, userLng) {
        if (!locationsData) return;
        
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
            const titleElement = card.querySelector('h3 a');
            const distanceElement = card.querySelector('.distance');
            
            if (titleElement && distanceElement) {
                const titleText = titleElement.textContent;
                const location = locationsData.locations.find(loc => loc.title === titleText);
                
                if (location) {
                    const distance = calculateDistance(userLat, userLng, location.coordinates.lat, location.coordinates.lng);
                    distanceElement.textContent = `(${Math.round(distance)} km)`;
                    distanceElement.classList.add('updated');
                }
            }
        });
    }
    
    function createCard(location) {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <input type="checkbox" class="visited-checkbox" data-place="${location.title}" />
            <label class="visited-label">Bezocht</label>
            <div class="category ${location.category}">${locationsData.categoryLabels[location.category]}</div>
            <h3><a href="${location.mapsUrl}" target="_blank">${location.title}</a></h3>
            <p>${location.description}</p>
            <div class="distance">(${location.distance} km)</div>
        `;
        return card;
    }
    
    function createFilterButtons() {
        const filterContainer = document.getElementById('filterButtons');
        const allButton = filterContainer.querySelector('[data-category="all"]');
        
        Object.keys(locationsData.categoryLabels).forEach(category => {
            const button = document.createElement('button');
            button.className = `filter-btn ${category} show-colored`;
            button.setAttribute('data-category', category);
            button.textContent = locationsData.categoryLabels[category];
            filterContainer.appendChild(button);
        });
    }
    
    function initializeFilters() {
        const filterButtons = document.querySelectorAll('.filter-btn');
        const cards = document.querySelectorAll('.card');
        
        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                filterButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                const category = this.getAttribute('data-category');
                
                if (category === 'all') {
                    filterButtons.forEach(btn => {
                        if (btn !== this) btn.classList.add('show-colored');
                    });
                } else {
                    filterButtons.forEach(btn => btn.classList.remove('show-colored'));
                }
                
                cards.forEach(card => {
                    if (category === 'all') {
                        card.classList.remove('hidden');
                    } else {
                        const cardCategory = card.querySelector('.category');
                        if (cardCategory && cardCategory.classList.contains(category)) {
                            card.classList.remove('hidden');
                        } else {
                            card.classList.add('hidden');
                        }
                    }
                });
            });
        });
    }
    
    function initializeCheckboxes() {
        const checkboxes = document.querySelectorAll('.visited-checkbox');
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const card = this.closest('.card');
                if (this.checked) {
                    card.classList.add('visited');
                } else {
                    card.classList.remove('visited');
                }
                saveVisitedPlaces();
            });
        });
    }
    
    function initializeLocation() {
        const locationBtn = document.getElementById('locationBtn');
        const locationStatus = document.getElementById('locationStatus');
        
        locationBtn.addEventListener('click', function() {
            if (!navigator.geolocation) {
                locationStatus.textContent = 'Geolocatie wordt niet ondersteund door je browser';
                locationStatus.style.color = '#e74c3c';
                return;
            }
            
            locationBtn.disabled = true;
            locationBtn.textContent = 'üìç Locatie ophalen...';
            locationStatus.textContent = 'Je locatie wordt opgehaald...';
            locationStatus.style.color = '#f39c12';
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    updateDistances(position.coords.latitude, position.coords.longitude);
                    
                    locationBtn.textContent = '‚úÖ Afstanden bijgewerkt';
                    locationStatus.textContent = 'Afstanden zijn bijgewerkt naar je huidige locatie!';
                    locationStatus.style.color = '#27ae60';
                    
                    setTimeout(() => {
                        locationBtn.disabled = false;
                        locationBtn.textContent = 'üìç Herbereken afstanden';
                    }, 2000);
                },
                function(error) {
                    let errorMessage = 'Er ging iets mis bij het ophalen van je locatie';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = 'Locatietoegang geweigerd. Geef toestemming in je browser.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = 'Locatie niet beschikbaar.';
                            break;
                        case error.TIMEOUT:
                            errorMessage = 'Timeout bij ophalen locatie.';
                            break;
                    }
                    
                    locationStatus.textContent = errorMessage;
                    locationStatus.style.color = '#e74c3c';
                    locationBtn.disabled = false;
                    locationBtn.textContent = 'üìç Probeer opnieuw';
                },
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 300000 }
            );
        });
    }
    
    // Robuuste JSON loading functie met fallbacks
    async function loadLocationsData() {
        const container = document.getElementById('cardsContainer');
        
        // Verschillende paden proberen in volgorde van voorkeur
        const dataPaths = [
            './data/',           // Directory-based approach (aanbevolen)
            './data/index.json', // Expliciete index.json
            './veluwe-locations.json', // Oude bestand als fallback
            './api/locations/'   // API-style directory
        ];
        
        for (const path of dataPaths) {
            try {
                console.log(`Proberen te laden: ${path}`);
                const response = await fetch(path);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log(`‚úÖ Succesvol geladen van: ${path}`);
                return data;
                
            } catch (error) {
                console.warn(`‚ùå Fout bij laden van ${path}:`, error.message);
                continue; // Probeer volgende pad
            }
        }
        
        // Als alle paden falen, toon error
        throw new Error('Alle datapaden gefaald');
    }
    
    async function initializeApp() {
        const container = document.getElementById('cardsContainer');
        
        try {
            // Laad data met fallback strategie
            locationsData = await loadLocationsData();
            
            // Clear loading message
            container.innerHTML = '';
            
            // Maak kaarten
            locationsData.locations.forEach(location => {
                container.appendChild(createCard(location));
            });
            
            // Maak filterbuttons
            createFilterButtons();
            
            // Initialiseer alles
            initializeFilters();
            initializeCheckboxes();
            initializeLocation();
            loadVisitedPlaces();
            
            console.log('‚úÖ App succesvol ge√Ønitialiseerd');
            
        } catch (error) {
            console.error('‚ùå Fout bij initialisatie:', error);
            container.innerHTML = `
                <div class="error-message">
                    <h3>‚ö†Ô∏è Kan locatiedata niet laden</h3>
                    <p>Er is een probleem met het laden van de locatiegegevens.</p>
                    <details style="margin-top: 10px;">
                        <summary style="cursor: pointer;">Technische details</summary>
                        <p style="margin-top: 5px; font-family: monospace; font-size: 0.9em;">
                            ${error.message}
                        </p>
                    </details>
                    <p style="margin-top: 15px;">
                        <strong>Mogelijke oplossingen:</strong><br>
                        ‚Ä¢ Maak een <code>data/</code> map met <code>index.json</code><br>
                        ‚Ä¢ Of plaats <code>veluwe-locations.json</code> in de hoofdmap<br>
                        ‚Ä¢ Controleer of GitHub Pages correct is geconfigureerd
                    </p>
                </div>
            `;
        }
    }
    
    document.addEventListener('DOMContentLoaded', initializeApp);
</script>
```

</body>
</html>